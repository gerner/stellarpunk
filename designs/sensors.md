Sensors
=======

Much of this is redundant/related to what's in combat.md.

# Desired Behaviors

Low profile (wrt sensor threshold) objects should be unidentified. We don't
know the identity, position, velocity or even type of object in some cases.

We get better readings as a function of both the instantaneous properties of
the target and how long we've been targeting them. For example at first we
might only know that there's a sensor target somewhere in a region. We might
not even be able to exactly quantify that uncertainty or region. As the target
is reveals itself (e.g. gets closer, uses thrusters) or we get a better fix on
the target (because we've been observing it for some time) we get a better idea
of those properties.

In Cold Waters there's even a feature/minigame where you have to help the
system id a target by looking at a sonic spectrum waterfall of the target.


## Sensor Noise

Model noise as a bias in our sensor readings: location and velocity. The
magnitude of this bias increases with decreasing sensor fidelity. The bias also
drifts over time. We want to avoid large drifts in the bias (e.g. jitter).

As fidelity improves, the bias should generally drift toward the actual
position, reducing the magnitude of the bias on average. The opposite is true
for deteriorating fidelity.

A given sensor image should have approximately the same or better accuracy as
it evolves over time as a newly targeted image with the same current sensor
fideltiy. That is, the accuracy of a sensor image targeted at one point and
then drifts over some time to a state with some new fidelity should be as
accurate or better than a new image of the same target made now.

At any given moment we can compute the amount of uncertainty in the sensor
image. This computation should give us the same result for a young or old
image. We can then choose/update the noise to have this much uncertainty. The
other characteristics of the noise can depend on existing noise for old images.
For instance, we can preserve the rough direction of bias in the location for
the target.

Holding fidelity/uncertainty constant, bias is approximately the same. For
instance, bias might lie along a line through the target with the distance
along that line from the target proportional to the uncertainty. We might add a
small amount of noise on top of that.

Pick a distance and angle offset for the target image relative to the dector.
Generate location bias along the line from the target image to the image plus
this offset. The distance along this line is proportional to uncertainty. Add
additional noise, small relative to that distance. All location biases will be
generated this way. The updated bias will be generated by combining the last
bias and this new bias according to the formula below:

```
let x be the amount of time (sec) since the last update
let a be a tunable parameter, seconds to allow moving half-way to new bias
alpha = 1/(-(1/a * x + 1)) + 1

updated bias = alpha * new bias + (1 - alpha) * old bias
```

# Display for Player

Player only gets to see SensorImage objects, not the underlying entity, unless
strictly necessary or the player's ship has fully resolved the object.

### Issues/TODOs
* icons and other entity display concerns for sensor images
* various target properties generally needed which might not be accessible if a
  sensor image is copied.

# Questions/Scenarios

* What happens if transponder is on? In concept this is transmitting full
  telemetry about the target, so shouldn't this make the target visible
  everywhere?
* What happens if transponder gets turned off? In concept we had full
  telemetry, so shouldn't we know exactly where the target is immediately after
  transponder goes off?
* If sensor fidelity decreases and then increases, should we keep the high
  accuracy position information or should that accuracy drop immediately? Do we
  know what the fidelity is exactly?
* How does target identification work? Do we know what kind of target we have
  right away? Is that revealed over time? Are there multiple levels or even a
  continuum of target identity information as fidelity increases?
* Releated to target identification, if we are special casing the transponder
  case, dow we treat some sensor contacts that are very well resolved, but
  without a transpondersimilarly? e.g. an asteroid that we want the player to
  interact with the same certainty of information as they would a friendly craft
  or station.

# Player Interactions with Sensor Contacts

* Target it and get info about the target (with info varying depending on
  fidelity/identification level)
* Go to/follow/pursue/evade the contact
* Dock with a station
* Jump through a gate
* Mine an asteroid
* Combat: launch a missile at a craft
